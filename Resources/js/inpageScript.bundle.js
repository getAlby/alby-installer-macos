(()=>{"use strict";const e="Prompt was closed",t="User rejected";var n;!function(e){e.AED="AED",e.AFN="AFN",e.ALL="ALL",e.AMD="AMD",e.ANG="ANG",e.AOA="AOA",e.ARS="ARS",e.AUD="AUD",e.AWG="AWG",e.AZN="AZN",e.BAM="BAM",e.BBD="BBD",e.BDT="BDT",e.BGN="BGN",e.BHD="BHD",e.BIF="BIF",e.BMD="BMD",e.BND="BND",e.BOB="BOB",e.BRL="BRL",e.BSD="BSD",e.BTN="BTN",e.BWP="BWP",e.BZD="BZD",e.CAD="CAD",e.CDF="CDF",e.CHF="CHF",e.CNY="CNY",e.COP="COP",e.CRC="CRC",e.CUP="CUP",e.CVE="CVE",e.CZK="CZK",e.DJF="DJF",e.DKK="DKK",e.DOP="DOP",e.DZD="DZD",e.EGP="EGP",e.ERN="ERN",e.ETB="ETB",e.EUR="EUR",e.FJD="FJD",e.GBP="GBP",e.GEL="GEL",e.GHS="GHS",e.GIP="GIP",e.GMD="GMD",e.GNF="GNF",e.GTQ="GTQ",e.GYD="GYD",e.HKD="HKD",e.HNL="HNL",e.HRK="HRK",e.HTG="HTG",e.HUF="HUF",e.IDR="IDR",e.ILS="ILS",e.INR="INR",e.IQD="IQD",e.IRR="IRR",e.ISK="ISK",e.JMD="JMD",e.JOD="JOD",e.JPY="JPY",e.KES="KES",e.KGS="KGS",e.KHR="KHR",e.KMF="KMF",e.KPW="KPW",e.KRW="KRW",e.KWD="KWD",e.KYD="KYD",e.KZT="KZT",e.LAK="LAK",e.LBP="LBP",e.LKR="LKR",e.LRD="LRD",e.LSL="LSL",e.LYD="LYD",e.MAD="MAD",e.MDL="MDL",e.MGA="MGA",e.MKD="MKD",e.MMK="MMK",e.MNT="MNT",e.MOP="MOP",e.MUR="MUR",e.MVR="MVR",e.MWK="MWK",e.MXN="MXN",e.MYR="MYR",e.NAD="NAD",e.NGN="NGN",e.NIO="NIO",e.NOK="NOK",e.NPR="NPR",e.NZD="NZD",e.OMR="OMR",e.PAB="PAB",e.PEN="PEN",e.PGK="PGK",e.PHP="PHP",e.PKR="PKR",e.PLN="PLN",e.PYG="PYG",e.QAR="QAR",e.RON="RON",e.RSD="RSD",e.RUB="RUB",e.RWF="RWF",e.SAR="SAR",e.SBD="SBD",e.SCR="SCR",e.SDG="SDG",e.SEK="SEK",e.SGD="SGD",e.SHP="SHP",e.SLL="SLL",e.SOS="SOS",e.SRD="SRD",e.SVC="SVC",e.SYP="SYP",e.SZL="SZL",e.THB="THB",e.TMT="TMT",e.TND="TND",e.TOP="TOP",e.TRY="TRY",e.TTD="TTD",e.TWD="TWD",e.TZS="TZS",e.UAH="UAH",e.UGX="UGX",e.USD="USD",e.UYU="UYU",e.UZS="UZS",e.VND="VND",e.VUV="VUV",e.WST="WST",e.XAF="XAF",e.XCD="XCD",e.XOF="XOF",e.XPF="XPF",e.ZAR="ZAR",e.ZMW="ZMW",e.ZWL="ZWL"}(n||(n={}));class r{constructor(){this.enabled=!1,this.isEnabled=!1,this.executing=!1}enable(){return this.enabled?Promise.resolve({enabled:!0}):this.execute("enable").then((e=>("boolean"==typeof e.enabled&&(this.enabled=e.enabled,this.isEnabled=e.enabled),e)))}getInfo(){if(!this.enabled)throw new Error("Provider must be enabled before calling getInfo");return this.execute("getInfo")}lnurl(e){if(!this.enabled)throw new Error("Provider must be enabled before calling lnurl");return this.execute("lnurl",{lnurlEncoded:e})}sendPayment(e){if(!this.enabled)throw new Error("Provider must be enabled before calling sendPayment");return this.execute("sendPaymentOrPrompt",{paymentRequest:e})}keysend(e){if(!this.enabled)throw new Error("Provider must be enabled before calling keysend");return this.execute("keysendOrPrompt",e)}makeInvoice(e){if(!this.enabled)throw new Error("Provider must be enabled before calling makeInvoice");return"object"!=typeof e&&(e={amount:e}),this.execute("makeInvoice",e)}signMessage(e){if(!this.enabled)throw new Error("Provider must be enabled before calling signMessage");return this.execute("signMessageOrPrompt",{message:e})}verifyMessage(e,t){if(!this.enabled)throw new Error("Provider must be enabled before calling verifyMessage");throw new Error("Alby does not support `verifyMessage`")}request(e,t){if(!this.enabled)throw new Error("Provider must be enabled before calling request");return this.execute("request",{method:e,params:t})}execute(e,t){return new Promise(((n,r)=>{window.postMessage({application:"LBE",prompt:!0,action:`webln/${e}`,scope:"webln",args:t},"*"),window.addEventListener("message",(function e(t){t.data&&t.data.response&&"LBE"===t.data.application&&"webln"===t.data.scope&&(t.data.data.error?r(new Error(t.data.data.error)):n(t.data.data.data),window.removeEventListener("message",e))}))}))}}if(document){window.webln||(window.webln=new r);const n=new Event("webln:ready");window.dispatchEvent(n),window.addEventListener("click",(n=>{const r=n.composedPath()[0];if(!r||!r.closest)return;const s=r.closest('[href^="lightning:" i]'),a=r.closest('[href^="lnurl" i]'),o=r.closest('[href*="lightning=ln" i]');let i,l,D,d;if(s||o||a){if(n.preventDefault(),s)i=s.getAttribute("href").toLowerCase(),l=i.replace("lightning:",""),d=s;else if(o){i=o.getAttribute("href").toLowerCase(),d=o;const e=new URL(i),t=new URLSearchParams(e.search);l=t.get("lightning")}else a&&(i=a.getAttribute("href").toLowerCase(),d=a,D=i.replace(/^lnurl[pwc]:/i,""));(l||D)&&(l&&l.startsWith("lnurl")&&(D=l.replace(/^lnurl[pwc]:/i,"")),l&&l.match(/(\S+@\S+)/)&&(D=l.match(/(\S+@\S+)/)[1]),window.webln.enable().then((n=>{if(n.enabled)return D?window.webln.lnurl(D).catch((n=>{console.error(n),[e,t].includes(n.message)||alert(`Error: ${n.message}`)})).then((e=>{const t=new CustomEvent("lightning:success",{bubbles:!0,detail:{lnurl:D,response:e}});d.dispatchEvent(t)})):window.webln.sendPayment(l).then((e=>{console.info(e);const t=new CustomEvent("lightning:success",{bubbles:!0,detail:{paymentRequest:l,response:e}});d.dispatchEvent(t)})).catch((n=>{console.error(n),[e,t].includes(n.message)||alert(`Error: ${n.message}`)}))})))}}),{capture:!0})}else console.warn("Failed to inject WebLN provider")})();